---
title: "RSA Algorithm: Math Overview"
description: "How RSA encryption and decryption work"
pubDate: 2016-12-24T01:15:28.000Z
tags: []
lang: en
slug: 20161224-rsa
---

How RSA works.

# RSA

RSA is asymmetric: (1) Bob generates a key pair (public, private). The public key is public; the private key is secret. (2) Alice encrypts with Bob’s public key. (3) Bob decrypts with his private key. The math below shows how the keys relate and why decryption works.

# Key generation

1. Choose two large primes p and q, p ≠ q. Set N = pq.
2. φ(N) = (p−1)(q−1) (Euler’s totient).
3. Choose e with 1 < e < φ(N) and gcd(e, φ(N)) = 1.
4. Find d such that d·e ≡ 1 (mod φ(N)).
5. Discard p and q.

Public key: (N, e). Private key: (N, d).

# Encrypt / decrypt

**Encrypt** (with public key (N, e)):  
m^e ≡ c (mod N), i.e. c = m^e mod N. Send c.

**Decrypt** (with private key (N, d)):  
c^d ≡ m (mod N), i.e. m = c^d mod N.

**Why it works**: Combining the two: m ≡ m^(ed) (mod N). The proof that m^(ed) ≡ m (mod N) uses Fermat’s little theorem and the construction of e, d; see e.g. [this explanation](http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html).

# Security

RSA can be broken by factoring N into p and q. For large enough N, factoring is infeasible with current technology, so RSA is considered secure when key size is chosen appropriately.
